---
import Layout from "../../layouts/Layout.astro";
import CatalogContainer from "../../components/catalog/CatalogContainer";

// Get query params
const categoria = Astro.url.searchParams.get("categoria");

// Categories for filtering
const categories = [
  { slug: "sofas", name: "Sofas" },
  { slug: "sillas", name: "Sillas" },
  { slug: "mesas", name: "Mesas" },
  { slug: "camas", name: "Camas" },
  { slug: "estanterias", name: "Estanterias" },
];

// Page title based on category
const pageTitle = categoria
  ? `${categories.find((c) => c.slug === categoria)?.name || "Catalogo"} - Muebleria Iris`
  : "Catalogo - Muebleria Iris";
---

<Layout title={pageTitle} description="Explora nuestra coleccion completa de muebles de alta calidad.">
  <section class="section bg-gray-50">
    <div class="container">
      <!-- Page Header -->
      <div class="mb-8">
        <nav class="text-sm text-gray-500 mb-4">
          <a href="/" class="hover:text-primary-600">Inicio</a>
          <span class="mx-2">/</span>
          <span class="text-gray-900">Catalogo</span>
          {
            categoria && (
              <>
                <span class="mx-2">/</span>
                <span class="text-gray-900 capitalize">{categoria}</span>
              </>
            )
          }
        </nav>

        <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
          <div>
            <h1 class="text-3xl lg:text-4xl font-bold text-gray-900">
              {categoria ? categories.find((c) => c.slug === categoria)?.name : "Catalogo"}
            </h1>
            <p class="text-gray-600 mt-2">
              {categoria ? `Todos los productos en ${categoria}` : "Explora toda nuestra coleccion"}
            </p>
          </div>
        </div>
      </div>

      <!-- Filters Bar -->
      <div class="flex flex-col lg:flex-row gap-4 mb-8">
        <!-- Category Pills -->
        <div class="flex flex-wrap gap-2">
          <a
            href="/catalogo"
            class={`px-4 py-2 rounded-full text-sm font-medium transition-colors ${
              !categoria
                ? "bg-primary-600 text-white"
                : "bg-white text-gray-700 hover:bg-gray-100 border border-gray-200"
            }`}
          >
            Todos
          </a>
          {
            categories.map((cat) => (
              <a
                href={`/catalogo?categoria=${cat.slug}`}
                class={`px-4 py-2 rounded-full text-sm font-medium transition-colors ${
                  categoria === cat.slug
                    ? "bg-primary-600 text-white"
                    : "bg-white text-gray-700 hover:bg-gray-100 border border-gray-200"
                }`}
              >
                {cat.name}
              </a>
            ))
          }
        </div>
      </div>

      <!-- Catalog Container with Real-time Filtering -->
      <CatalogContainer 
        client:load 
        categoria={categoria} 
      />
    </div>
  </section>
</Layout>
